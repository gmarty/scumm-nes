function t(t,e,n,o){Object.defineProperty(t,e,{get:n,set:o,enumerable:!0,configurable:!0})}var e=globalThis.parcelRequire3956,n=e.register;n("i9q43",function(n,o){t(n.exports,"default",()=>s);var i=e("ke1uA"),r=e("lfFYM"),l=e("5s9p1"),s=(t,e)=>{let n=[],o=[],s=[];for(let o=0;o<e.rooms.length;o++){let[r,l]=e.rooms[o];if(0===l)continue;let s=t.slice(r,r+l),f=(0,i.default)(s,o,r,e.characters);f.buffer=s,n.push(f)}for(let n=0;n<e.roomgfx.length;n++){let[i,l]=e.roomgfx[n],s=t.slice(i,i+l),f=(0,r.default)(s,n,i);f.buffer=s,o.push(f)}for(let n=0;n<e.preplist.length;n++){let[o,i]=e.preplist[n],r=t.slice(o,o+i),f=(0,l.default)(r,n,o,e.characters);f.buffer=r,s.push(f)}return{rooms:n,roomgfx:o,preps:s}}}),n("ke1uA",function(n,o){t(n.exports,"default",()=>s);var i=e("6iSCY"),r=e("gkxcz");let l=console.assert;var s=(t,e,n=0,o={})=>{let s=new i.default(t),f={id:e,offset:n,size:t.byteLength},a=s.getUint16();l(a===t.byteLength,"Room res size flag does not match chunk size.");let g=s.getUint8(),u=s.getUint8();l(0===g,"Unknown 1 is not 0.");let h=s.getUint16(),p=s.getUint16();l(28===h||60===h,"Room width is not 28 or 60."),l(16===p,"Room height is not 16.");let U=s.getUint16();l(0===U,"Unknown 3 is not 0.");let c=s.getUint16(),m=s.getUint16(),b=s.getUint16(),d=s.getUint16(),k=s.getUint16();l(d===k,"The values of unknown 4 and 5 do not match.");let w=s.getUint8();l(w<57,"There are more than 56 objects in room.");let y=s.getUint8(),x=s.getUint8();l(0===x,"The number of sounds is not 0.");let j=s.getUint8(),O=s.getUint16(),v=s.getUint16(),z=[{type:"header",from:0,to:28}],A=[],S=[],T=[];O>0&&z.push({type:"excdOffs",from:O,to:v-1}),v>0&&z.push({type:"encdOffs",from:v,to:a-1});let L=new i.default(t.slice(c)),M=L.getUint8(),Y=[],C=Array(16);for(let t=0;t<16;t++)Y[t]=L.getUint8();for(let t=0;t<16;t++){C[t]=Array(64).fill(0),C[t][0]=0,C[t][1]=0;let e=0;for(;e<h;){let n=L.getUint8();if(128&n)for(let o=0;o<(127&n);o++)C[t][2+e++]=L.getUint8();else{let o=L.getUint8();for(let i=0;i<(127&n);i++)C[t][2+e++]=o}}}z.push({type:"nametable",from:c,to:c+L.pointer-1}),l(c+L.pointer===m,"name table overlaps on attributes table.");let I=new i.default(t.slice(m)),N=Array(64).fill(0);for(let t=0;t<64;){let e=I.getUint8();if(128&e)for(let n=0;n<(127&e);n++)N[t++]=I.getUint8();else{let n=I.getUint8();for(let o=0;o<(127&e);o++)N[t++]=n}7&t||28!==h||(t+=8)}z.push({type:"attributes",from:m,to:m+I.pointer-1}),l(m+I.pointer===b,"Attributes table overlaps on mask table.");let R=new i.default(t.slice(b)),q=R.getUint8();l(0===q||1===q,"hasMask is neither 0 nor 1.");let B={hasMask:!!q};if(1===q){let t=Array(16).fill([]),n=R.getUint8();for(e=0;e<16;e++){t[e]=Array(8).fill(0);let o=0;for(;o<n;){let n=R.getUint8();if(128&n)for(let i=0;i<(127&n);i++)t[e][o++]=R.getUint8();else{let i=R.getUint8();for(let r=0;r<(127&n);r++)t[e][o++]=i}}}B.masktableObj=t,z.push({type:"masktable",from:b,to:b+R.pointer-1})}else z.push({type:"masktable",from:b,to:b});w>0&&z.push({type:"objectImagesOffs",from:28,to:28+2*w},{type:"objectsOffs",from:28+2*w,to:28+4*w-1});let D=[],F=[],P=new i.default(t.slice(28)),V=new i.default(t.slice(28+2*w));for(let t=0;t<w;t++)D.push(P.getUint16()),F.push(V.getUint16());let X=Math.min(...F),E={type:"objectImages",from:Math.min(...D),to:0},G={type:"objects",from:X,to:0};for(let e=0;e<w;e++){let n;let s=D[e],f=F[e],a=new i.default(t.slice(f)),g=a.getUint16(),u=a.getUint8(),h=a.getUint8();l(0===u,"Unknown 1 is not 0."),l(0===h,"Unknown 2 is not 0.");let p=a.getUint16(),U=a.getUint8();l(0===U,"Unknown 3 is not 0.");let c=a.getUint8(),m=a.getUint8(),b=127&m,d=(128&m?1:0)*8,k=a.getUint8(),w=a.getUint8(),y=a.getUint8(),x=31&a.getUint8(),j=a.getUint8(),O=7&j,v=(248&j)/8,z=a.getUint8();l(!(z%2),"Object name offset is an odd number."),l(z>=16,"Object name offset is less than 16."),l(z<255,"Object name offset is more than 255.");let T=new i.default(t.slice(f+z,f+g)),L="",M="";try{do{if(M=T.getUint8(),0===M)break;L+=(0,r.decodeChar)(M,o)}while(T.pointer<g)}catch(t){console.error(t)}let Y=new i.default(t.slice(f+15,f+g)),C=[];for(cur=15;Y.pointer<g;){let t=Y.getUint8();if(0===t)break;C.push([t,Y.getUint8()])}if(s===X)n=null;else{let e=new i.default(t.slice(s));n=Array(v);for(let t=0;t<v;t++){n[t]=[];let o=0;for(;o<k;){let i=e.getUint8();if(128&i)for(let r=0;r<(127&i);r++)n[t][o++]=e.getUint8();else{let r=e.getUint8();for(let e=0;e<(127&i);e++)n[t][o++]=r}}}}A.push({tiles:n}),G.to<f+cur&&(G.to=f+cur),l((z-16)/2===C.length,"Unknown data before object name offset."),S.push({size:g,objUnk1:u,objUnk2:h,num:p,objUnk3:U,x:c,y:b,parent:w,parentState:d,width:k,height:v,walkToX:y,walkToY:x,actorDir:O,nameOffs:z,name:L,objScripts:C})}l(A.length===S.length,"Length of object images and objects do not match."),E.to=G.from-1,w>0&&z.push(G,E);let H=new i.default(t.slice(y)),J=H.getUint8();for(let t=0;t<J;t++){let t=H.getUint8(),e=H.getUint8(),n=H.getUint8(),o=H.getUint8(),i=H.getUint8(),r=H.getUint8(),s=H.getUint8(),f=H.getUint8();l(0===s||1===s,"Box mask is neither 0 nor 1."),l(0===f||5===f,"Box flag is neither 0 nor 5."),T.push({uy:t,ly:e,ulx:n,urx:o,llx:i,lrx:r,mask:s,flags:f})}z.push({type:"boxes",from:y,to:H.pointer-1});let K={type:"matrix",from:H.pointer-1,to:H.pointer-1+J*(J+1)},Q=[];for(let t=0;t<J;t++)for(let t=0;t<J;t++)Q.push(H.getUint8());return z.push(K),z.sort((t,e)=>t.from-e.from),{metadata:f,header:{chunkSize:a,unk1:g,unk2:u,width:h,height:p,unk3:U,nametableOffs:c,attrOffs:m,maskOffs:b,unk4:d,unk5:k,objectsNum:w,boxOffs:y,soundsNum:x,scriptsNum:j,excdOffs:O,encdOffs:v},objectImagesOffs:D,objectsOffs:F,boxes:T,matrix:Q,nametable:{tileset:M,palette:Y,nametableObj:C},attributes:N,masktable:B,objectImages:A,objects:S,hasMask:q,map:z}}}),n("6iSCY",function(e,n){t(e.exports,"default",()=>o);var o=class{#t;#e=0;constructor(t){this.#t=new DataView(t)}getUint8(){return this.#t.getUint8(this.#e++)}getUint16(){let t=this.#t.getUint16(this.#e,!0);return this.#e+=2,t}get pointer(){return this.#e}}}),n("lfFYM",function(n,o){t(n.exports,"default",()=>l);var i=e("6iSCY");let r=console.assert;var l=(t,e,n=0)=>{let o=new i.default(t),l={id:e,offset:n,size:t.byteLength,decompressedSize:0},s=o.getUint8(),f=[];for(;o.pointer<t.byteLength;){let t=o.getUint8();if(128&t)for(let e=0;e<(127&t);e++)f.push(o.getUint8());else{let e=o.getUint8();for(let n=0;n<(127&t);n++)f.push(e)}}return r(s===f.length/8/2,"Number of tiles byte does not match number of tiles decoded."),l.decompressedSize=f.length,{metadata:l,numberOfTiles:s,gfx:f}}}),n("5s9p1",function(n,o){t(n.exports,"default",()=>s);var i=e("6iSCY"),r=e("gkxcz");let l=console.assert;var s=(t,e,n=0,o={})=>{let s;let f=new i.default(t),a={id:e,offset:n,size:t.byteLength},g=[],u="";for(let e=0;e<t.byteLength;e++){if(0===(s=f.getUint8())){g.push(u),u="";continue}u+=(0,r.decodeChar)(s,o)}return l(0===s,"The final character is not 0x00."),{metadata:a,preps:g}}});
//# sourceMappingURL=parseRom.d53551bd.js.map
